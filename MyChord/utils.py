import numpy as np
from numpy import ndarray


def PI2array(ndigits: int = 100) -> ndarray:
    pi = PI[:ndigits]
    array = np.zeros((10, 10), dtype=int)
    for i, j in zip(pi[:-1], pi[1:]):
        array[int(i), int(j)] += 1
    return array

def compute_freq(data: ndarray) -> ndarray:
    assert data.ndim == 2, "data.ndim must be 2 to draw a chord plot!"
    return data.sum(axis=0) + data.sum(axis=1)

def compute_locs(data: ndarray, 
                 node_ratio: float = 2,
                 gap_ratio: float = 1.5) -> list[ndarray]:
    freq = compute_freq(data)
    freq = (freq / node_ratio).astype(int)

    freq_ = (freq - 1) + gap_ratio
    prop = freq_ / freq_.sum()
    gap = gap_ratio / freq_.sum()
    
    c = data.shape[0]
    tri = np.triu(np.ones((c, c+1)), k=1)
    cprop = prop @ tri

    prop_range = np.vstack((cprop[:-1], cprop[1:] - gap)).T
    locs = [2*np.pi*np.linspace(*prop_range[i], freq[i]) for i in range(len(freq))]

    return locs
    



PI = "\
3141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067\
9821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819\
6442881097566593344612847564823378678316527120190914564856692346034861045432664821339360726024914127\
3724587006606315588174881520920962829254091715364367892590360011330530548820466521384146951941511609\
4330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491\
2983367336244065664308602139494639522473719070217986094370277053921717629317675238467481846766940513\
2000568127145263560827785771342757789609173637178721468440901224953430146549585371050792279689258923\
5420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185\
9502445945534690830264252230825334468503526193118817101000313783875288658753320838142061717766914730\
3598253490428755468731159562863882353787593751957781857780532171226806613001927876611195909216420198\
9380952572010654858632788659361533818279682303019520353018529689957736225994138912497217752834791315\
1557485724245415069595082953311686172785588907509838175463746493931925506040092770167113900984882401\
2858361603563707660104710181942955596198946767837449448255379774726847104047534646208046684259069491\
2933136770289891521047521620569660240580381501935112533824300355876402474964732639141992726042699227\
9678235478163600934172164121992458631503028618297455570674983850549458858692699569092721079750930295\
5321165344987202755960236480665499119881834797753566369807426542527862551818417574672890977772793800\
0816470600161452491921732172147723501414419735685481613611573525521334757418494684385233239073941433\
3454776241686251898356948556209921922218427255025425688767179049460165346680498862723279178608578438\
3827967976681454100953883786360950680064225125205117392984896084128488626945604241965285022210661186\
3067442786220391949450471237137869609563643719172874677646575739624138908658326459958133904780275900\
9946576407895126946839835259570982582262052248940772671947826848260147699090264013639443745530506820\
3496252451749399651431429809190659250937221696461515709858387410597885959772975498930161753928468138\
2686838689427741559918559252459539594310499725246808459872736446958486538367362226260991246080512438\
8439045124413654976278079771569143599770012961608944169486855584840635342207222582848864815845602850\
6016842739452267467678895252138522549954666727823986456596116354886230577456498035593634568174324112\
5150760694794510965960940252288797108931456691368672287489405601015033086179286809208747609178249385\
8900971490967598526136554978189312978482168299894872265880485756401427047755513237964145152374623436\
4542858444795265867821051141354735739523113427166102135969536231442952484937187110145765403590279934\
4037420073105785390621983874478084784896833214457138687519435064302184531910484810053706146806749192\
7819119793995206141966342875444064374512371819217999839101591956181467514269123974894090718649423196\
1567945208095146550225231603881930142093762137855956638937787083039069792077346722182562599661501421\
5030680384477345492026054146659252014974428507325186660021324340881907104863317346496514539057962685\
6100550810665879699816357473638405257145910289706414011097120628043903975951567715770042033786993600\
7230558763176359421873125147120532928191826186125867321579198414848829164470609575270695722091756711\
6722910981690915280173506712748583222871835209353965725121083579151369882091444210067510334671103141\
2671113699086585163983150197016515116851714376576183515565088490998985998238734552833163550764791853\
5893226185489632132933089857064204675259070915481416549859461637180270981994309924488957571282890592\
3233260972997120844335732654893823911932597463667305836041428138830320382490375898524374417029132765\
6180937734440307074692112019130203303801976211011004492932151608424448596376698389522868478312355265\
8213144957685726243344189303968642624341077322697802807318915441101044682325271620105265227211166039\
6665573092547110557853763466820653109896526918620564769312570586356620185581007293606598764861179104\
5334885034611365768675324944166803962657978771855608455296541266540853061434443185867697514566140680\
0700237877659134401712749470420562230538994561314071127000407854733269939081454664645880797270826683\
0634328587856983052358089330657574067954571637752542021149557615814002501262285941302164715509792592\
3099079654737612551765675135751782966645477917450112996148903046399471329621073404375189573596145890\
1938971311179042978285647503203198691514028708085990480109412147221317947647772622414254854540332157\
1853061422881375850430633217518297986622371721591607716692547487389866549494501146540628433663937900\
3976926567214638530673609657120918076383271664162748888007869256029022847210403172118608204190004229\
6617119637792133757511495950156604963186294726547364252308177036751590673502350728354056704038674351\
3622224771589150495309844489333096340878076932599397805419341447377441842631298608099888687413260472\
1569516239658645730216315981931951673538129741677294786724229246543668009806769282382806899640048243\
5403701416314965897940924323789690706977942236250822168895738379862300159377647165122893578601588161\
7557829735233446042815126272037343146531977774160319906655418763979293344195215413418994854447345673\
8316249934191318148092777710386387734317720754565453220777092120190516609628049092636019759882816133\
2316663652861932668633606273567630354477628035045077723554710585954870279081435624014517180624643626\
7945612753181340783303362542327839449753824372058353114771199260638133467768796959703098339130771098\
7040859133746414428227726346594704745878477872019277152807317679077071572134447306057007334924369311\
3835049316312840425121925651798069411352801314701304781643788518529092854520116583934196562134914341\
5956258658655705526904965209858033850722426482939728584783163057777560688876446248246857926039535277\
3480304802900587607582510474709164396136267604492562742042083208566119062545433721315359584506877246\
0290161876679524061634252257719542916299193064553779914037340432875262888963995879475729174642635745\
5254079091451357111369410911939325191076020825202618798531887705842972591677813149699009019211697173\
7278476847268608490033770242429165130050051683233643503895170298939223345172201381280696501178440874\
5196012122859937162313017114448464090389064495444006198690754851602632750529834918740786680881833851\
0228334508504860825039302133219715518430635455007668282949304137765527939751754613953984683393638304\
7461199665385815384205685338621867252334028308711232827892125077126294632295639898989358211674562701\
0218356462201349671518819097303811980049734072396103685406643193950979019069963955245300545058068550\
1956730229219139339185680344903982059551002263535361920419947455385938102343955449597783779023742161\
7271117236434354394782218185286240851400666044332588856986705431547069657474585503323233421073015459\
4051655379068662733379958511562578432298827372319898757141595781119635833005940873068121602876496286\
7446047746491599505497374256269010490377819868359381465741268049256487985561453723478673303904688383\
4363465537949864192705638729317487233208376011230299113679386270894387993620162951541337142489283072\
2012690147546684765357616477379467520049075715552781965362132392640616013635815590742202020318727760\
5277219005561484255518792530343513984425322341576233610642506390497500865627109535919465897514131034\
8227693062474353632569160781547818115284366795706110861533150445212747392454494542368288606134084148\
6377670096120715124914043027253860764823634143346235189757664521641376796903149501910857598442391986\
2916421939949072362346468441173940326591840443780513338945257423995082965912285085558215725031071257\
0126683024029295252201187267675622041542051618416348475651699981161410100299607838690929160302884002\
6910414079288621507842451670908700069928212066041837180653556725253256753286129104248776182582976515\
7959847035622262934860034158722980534989650226291748788202734209222245339856264766914905562842503912\
7577102840279980663658254889264880254566101729670266407655904290994568150652653053718294127033693137\
8517860904070866711496558343434769338578171138645587367812301458768712660348913909562009939361031029\
1616152881384379099042317473363948045759314931405297634757481193567091101377517210080315590248530906\
6920376719220332290943346768514221447737939375170344366199104033751117354719185504644902636551281622\
8824462575916333039107225383742182140883508657391771509682887478265699599574490661758344137522397096\
8340800535598491754173818839994469748676265516582765848358845314277568790029095170283529716344562129\
6404352311760066510124120065975585127617858382920419748442360800719304576189323492292796501987518721\
2726750798125547095890455635792122103334669749923563025494780249011419521238281530911407907386025152\
2742995818072471625916685451333123948049470791191532673430282441860414263639548000448002670496248201\
7928964766975831832713142517029692348896276684403232609275249603579964692565049368183609003238092934\
5958897069536534940603402166544375589004563288225054525564056448246515187547119621844396582533754388\
5690941130315095261793780029741207665147939425902989695946995565761218656196733786236256125216320862\
8692221032748892186543648022967807057656151446320469279068212073883778142335628236089632080682224680\
1224826117718589638140918390367367222088832151375560037279839400415297002878307667094447456013455641\
7254370906979396122571429894671543578468788614445812314593571984922528471605049221242470141214780573\
4551050080190869960330276347870810817545011930714122339086639383395294257869050764310063835198343893\
4159613185434754649556978103829309716465143840700707360411237359984345225161050702705623526601276484\
8308407611830130527932054274628654036036745328651057065874882256981579367897669742205750596834408697\
3502014102067235850200724522563265134105592401902742162484391403599895353945909440704691209140938700\
1264560016237428802109276457931065792295524988727584610126483699989225695968815920560010165525637567\
"
